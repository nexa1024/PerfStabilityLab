# Week 6：UI 性能（布局/过绘/列表）+ 二分（minSdk 26）

> 本周目标：把 UI 性能从“观感优化”升级为“可解释的证据链”：布局层级、RecyclerView 绑定/刷新策略、过度绘制与频繁请求布局。  
> 本周交付：1 个布局对照实验 + 1 个 RecyclerView 掉帧对照实验 + UI 性能一页纸。

---

## 每日固定配方（90 分钟）

- 15m 算法：二分（边界写法/答案二分）1 题
- 45m 阅读 + 笔记：UI 性能瓶颈类型与排查工具
- 25m Demo：做对照实验（坏→好）并记录证据
- 5m 输出：卡片 1 张

---

## Day 1：二分边界 + UI 性能指标

- 算法：二分查找边界题 1 道（`l<=r`/`l<r` 任选一种并固定写法）。
- 阅读笔记：写《UI 性能我关心的 3 件事》
  - 帧耗时、主线程耗时、列表绑定/布局次数
- Demo：在 `LayoutJankLab` 输出“布局复杂度说明”（层级/子 View 数）到日志区。
- 输出卡片：《二分边界：我固定一种写法》。

验收：二分题写法固定不摇摆；UI 性能有关注指标而不是“感觉快了”。

---

## Day 2：布局对照实验（深层级 vs 简化）

- 算法：答案二分题 1 道（找最小可行值/最大可行值）。
- 阅读笔记：写《布局优化优先级》
  - 减少层级、避免重复测量、减少 requestLayout 触发
- Demo：
  - `LayoutJankLab`
    - 复现：加载深层级 XML（或动态生成大量嵌套）
    - 修复：替换为扁平布局（ConstraintLayout/merge 等）
    - 验证：用 Layout Inspector 或 trace/日志对比耗时
- 输出卡片：《布局对照：复现/修复/验证怎么写》。

验收：能给出“为什么这个布局慢”的解释（层级/测量次数/请求布局）。

---

## Day 3：RecyclerView 掉帧对照（坏刷新策略 vs 好策略）

- 算法：二分综合 1 题。
- 阅读笔记：写《RecyclerView 掉帧常见原因》
  - 频繁 `notifyDataSetChanged`、Item 过重、绑定做重活、图片解码主线程
- Demo：
  - 新增 `RecyclerJankLab`
    - 复现：在 `onBindViewHolder` 做重计算/频繁全量刷新
    - 修复：DiffUtil + 预计算/后台处理 + 合理 payload
    - 验证：滑动观感 + trace/Profiler 证据（至少能定位耗时发生在 bind）
- 输出卡片：《列表掉帧：我先排查 bind 还是 layout》。

验收：能说清“耗时发生在绑定还是布局/绘制”，并有证据支撑。

---

## Day 4：过度绘制/频繁 invalidate & requestLayout

- 算法：二分补短板 1 题（写清终止条件与返回值）。
- 阅读笔记：写《invalidate vs requestLayout 的区别》（到能解释层面）。
- Demo：
  - 在 `JankLab` 或新建 `InvalidateLab`
    - 复现：高频触发 `requestLayout()` 或 `invalidate()`
    - 修复：降频、合并更新、只在必要时触发
    - 验证：观察帧耗时/trace 变化（先能观察到明显差异即可）
- 输出卡片：《requestLayout/invalidate 一句话区别》。

验收：你能解释“为什么频繁 requestLayout 会更重”，并能在 Demo 里看到差异。

---

## Day 5：UI 性能总结（工具与结论）

- 算法：错题复盘 1 题（把错因写成规则）。
- 阅读笔记：输出《UI 性能一页纸》
  - 布局、列表、绘制/刷新三大块的排查顺序与常见修复
- Demo：给 `LayoutJankLab` 与 `RecyclerJankLab` 的“验证”按钮补齐 2 行结论输出。
- 输出卡片：《我如何写 UI 性能证据》。

验收：每个 UI 实验都能给出一句话“证据 + 结论”。

---

## Day 6：周复盘（UI 两个对照实验固化）

- 算法：补一题二分最弱点（边界/答案二分任选）。
- 阅读笔记：把本周结论并入《卡顿排查清单》（新增 UI 分支）。
- Demo：确保至少 2 个 UI 对照实验可稳定复现并形成证据链。
- 输出卡片：《Week6 我能讲清的 UI 性能问题》。

本周验收：你能演示“布局对照”和“列表对照”两套实验，并解释为什么修复有效。

